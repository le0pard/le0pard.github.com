// Generated by CoffeeScript 1.3.3
(function() {
  var LeoSite;

  LeoSite = {
    repos: [],
    recentlyUpdatedRepos: [],
    reposInclude: ["mongodb_logger", "omniauth-yammer", "postgresql_book", "couch_yammer", "LibreOfficeCSVGenerator", "my_little_nosql", "webp-ffi"],
    additionalProjects: [
      {
        "html_url": "https://github.com/railsware/libskypekit",
        "owner": {
          "login": "railsware",
          "gravatar_id": "567813ae37032181ef4de2ba5900f07b",
          "url": "https://api.github.com/users/railsware",
          "avatar_url": "https://secure.gravatar.com/avatar/567813ae37032181ef4de2ba5900f07b?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-orgs.png",
          "id": 9354
        },
        "description": "Thread-safe C library with synchronous API using asynchronous C++ SkypeKit SDK",
        "clone_url": "https://github.com/railsware/libskypekit.git",
        "git_url": "git://github.com/railsware/libskypekit.git",
        "has_wiki": true,
        "ssh_url": "git@github.com:railsware/libskypekit.git",
        "watchers": 10,
        "forks_count": 2,
        "has_issues": true,
        "watchers_count": 10,
        "pushed_at": "2012-05-11T14:29:53Z",
        "forks": 2,
        "language": "C++",
        "created_at": "2012-05-10T12:35:05Z",
        "open_issues": 1,
        "open_issues_count": 1,
        "mirror_url": null,
        "size": 104,
        "fork": false,
        "updated_at": "2012-06-22T14:31:36Z",
        "full_name": "railsware/libskypekit",
        "name": "libskypekit",
        "url": "https://api.github.com/repos/railsware/libskypekit",
        "svn_url": "https://github.com/railsware/libskypekit",
        "private": false,
        "id": 4284261,
        "has_downloads": true,
        "homepage": "http://railsware.github.com/libskypekit/"
      }, {
        "html_url": "https://github.com/railsware/piro",
        "owner": {
          "login": "railsware",
          "gravatar_id": "567813ae37032181ef4de2ba5900f07b",
          "url": "https://api.github.com/users/railsware",
          "avatar_url": "https://secure.gravatar.com/avatar/567813ae37032181ef4de2ba5900f07b?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-orgs.png",
          "id": 9354
        },
        "description": "PiRo - it's Rocket for you Pivotal Tracker account",
        "clone_url": "https://github.com/railsware/piro.git",
        "git_url": "git://github.com/railsware/piro.git",
        "has_wiki": true,
        "ssh_url": "git@github.com:railsware/piro.git",
        "watchers": 28,
        "forks_count": 6,
        "has_issues": true,
        "watchers_count": 28,
        "pushed_at": "2012-05-26T09:46:15Z",
        "forks": 6,
        "language": "CoffeeScript",
        "created_at": "2011-12-27T22:08:34Z",
        "open_issues": 1,
        "open_issues_count": 1,
        "mirror_url": null,
        "size": 264,
        "fork": false,
        "updated_at": "2012-07-27T20:52:39Z",
        "full_name": "railsware/piro",
        "name": "piro",
        "url": "https://api.github.com/repos/railsware/piro",
        "svn_url": "https://github.com/railsware/piro",
        "private": false,
        "id": 3059286,
        "has_downloads": true,
        "homepage": "piro.railsware.com"
      }, {
        "html_url": "https://github.com/railsware/dev_vagrant_box",
        "owner": {
          "login": "railsware",
          "gravatar_id": "567813ae37032181ef4de2ba5900f07b",
          "url": "https://api.github.com/users/railsware",
          "avatar_url": "https://secure.gravatar.com/avatar/567813ae37032181ef4de2ba5900f07b?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-orgs.png",
          "id": 9354
        },
        "description": "Vagrant box for development (ruby, rails)",
        "clone_url": "https://github.com/railsware/dev_vagrant_box.git",
        "git_url": "git://github.com/railsware/dev_vagrant_box.git",
        "has_wiki": true,
        "ssh_url": "git@github.com:railsware/dev_vagrant_box.git",
        "watchers": 2,
        "forks_count": 1,
        "has_issues": true,
        "watchers_count": 2,
        "pushed_at": "2012-06-07T10:06:56Z",
        "forks": 1,
        "language": null,
        "created_at": "2012-06-06T13:04:42Z",
        "open_issues": 0,
        "open_issues_count": 0,
        "mirror_url": null,
        "size": 384,
        "fork": false,
        "updated_at": "2012-07-13T16:15:36Z",
        "full_name": "railsware/dev_vagrant_box",
        "name": "dev_vagrant_box",
        "url": "https://api.github.com/repos/railsware/dev_vagrant_box",
        "svn_url": "https://github.com/railsware/dev_vagrant_box",
        "private": false,
        "id": 4572629,
        "has_downloads": true,
        "homepage": "http://railsware.github.com/dev_vagrant_box/"
      }, {
        "html_url": "https://github.com/railsware/skypekit",
        "owner": {
          "login": "railsware",
          "gravatar_id": "567813ae37032181ef4de2ba5900f07b",
          "url": "https://api.github.com/users/railsware",
          "avatar_url": "https://secure.gravatar.com/avatar/567813ae37032181ef4de2ba5900f07b?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-orgs.png",
          "id": 9354
        },
        "description": "Ruby FFI interface to libskypekit C library",
        "clone_url": "https://github.com/railsware/skypekit.git",
        "git_url": "git://github.com/railsware/skypekit.git",
        "has_wiki": true,
        "ssh_url": "git@github.com:railsware/skypekit.git",
        "watchers": 37,
        "forks_count": 1,
        "has_issues": true,
        "watchers_count": 37,
        "pushed_at": "2012-06-28T21:05:42Z",
        "forks": 1,
        "language": "Ruby",
        "created_at": "2012-05-10T13:34:48Z",
        "open_issues": 0,
        "open_issues_count": 0,
        "mirror_url": null,
        "size": 988,
        "fork": false,
        "updated_at": "2012-08-03T18:07:41Z",
        "full_name": "railsware/skypekit",
        "name": "skypekit",
        "url": "https://api.github.com/repos/railsware/skypekit",
        "svn_url": "https://github.com/railsware/skypekit",
        "private": false,
        "id": 4284848,
        "has_downloads": true,
        "homepage": "http://railsware.github.com/skypekit/"
      }, {
        "html_url": "https://github.com/railsware/smt_rails",
        "owner": {
          "login": "railsware",
          "gravatar_id": "567813ae37032181ef4de2ba5900f07b",
          "url": "https://api.github.com/users/railsware",
          "avatar_url": "https://secure.gravatar.com/avatar/567813ae37032181ef4de2ba5900f07b?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-orgs.png",
          "id": 9354
        },
        "description": "Shared mustache templates for rails 3.",
        "clone_url": "https://github.com/railsware/smt_rails.git",
        "git_url": "git://github.com/railsware/smt_rails.git",
        "has_wiki": true,
        "ssh_url": "git@github.com:railsware/smt_rails.git",
        "watchers": 63,
        "forks_count": 7,
        "has_issues": true,
        "watchers_count": 63,
        "pushed_at": "2012-07-14T01:39:19Z",
        "forks": 7,
        "language": "Ruby",
        "created_at": "2012-04-10T17:32:53Z",
        "open_issues": 0,
        "open_issues_count": 0,
        "mirror_url": null,
        "size": 140,
        "fork": false,
        "updated_at": "2012-08-04T06:04:03Z",
        "full_name": "railsware/smt_rails",
        "name": "smt_rails",
        "url": "https://api.github.com/repos/railsware/smt_rails",
        "svn_url": "https://github.com/railsware/smt_rails",
        "private": false,
        "id": 3985037,
        "has_downloads": true,
        "homepage": "http://blog.railsware.com/2012/04/12/shared-mustache-templates-for-rails-3/"
      }, {
        "html_url": "https://github.com/railsware/sht_rails",
        "owner": {
          "login": "railsware",
          "gravatar_id": "567813ae37032181ef4de2ba5900f07b",
          "url": "https://api.github.com/users/railsware",
          "avatar_url": "https://secure.gravatar.com/avatar/567813ae37032181ef4de2ba5900f07b?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-orgs.png",
          "id": 9354
        },
        "description": "Shared handlebars templates for Rails 3",
        "clone_url": "https://github.com/railsware/sht_rails.git",
        "git_url": "git://github.com/railsware/sht_rails.git",
        "has_wiki": true,
        "ssh_url": "git@github.com:railsware/sht_rails.git",
        "watchers": 16,
        "forks_count": 2,
        "has_issues": true,
        "watchers_count": 16,
        "pushed_at": "2012-05-21T11:54:11Z",
        "forks": 2,
        "language": "Ruby",
        "created_at": "2012-05-19T21:36:59Z",
        "open_issues": 0,
        "open_issues_count": 0,
        "mirror_url": null,
        "size": 192,
        "fork": false,
        "updated_at": "2012-08-04T05:36:26Z",
        "full_name": "railsware/sht_rails",
        "name": "sht_rails",
        "url": "https://api.github.com/repos/railsware/sht_rails",
        "svn_url": "https://github.com/railsware/sht_rails",
        "private": false,
        "id": 4381088,
        "has_downloads": true,
        "homepage": "http://blog.railsware.com/2012/05/21/shared-handlebars-templates-for-rails-3/"
      }
    ],
    init: function() {
      return $.getJSON("https://api.github.com/users/le0pard/repos?type=public&per_page=100&callback=?", function(result) {
        var myRepos;
        myRepos = result.data;
        return $(function() {
          var repos;
          $.each(myRepos, function(i, repo) {
            if (repo.name && $.inArray(repo.name, LeoSite.reposInclude) !== -1) {
              return LeoSite.repos.push(repo);
            }
          });
          repos = LeoSite.repos.concat(LeoSite.additionalProjects);
          $.each(repos, function(i, repo) {
            var createdDelta, pushDelta, weekHalfLife, weightForPush, weightForWatchers;
            repo.pushed_at = new Date(repo.pushed_at);
            weekHalfLife = 1.146 * Math.pow(10, -9);
            pushDelta = (new Date) - Date.parse(repo.pushed_at);
            createdDelta = (new Date) - Date.parse(repo.created_at);
            weightForPush = 1;
            weightForWatchers = 1.314 * Math.pow(10, 7);
            repo.hotness = weightForPush * Math.pow(Math.E, -1 * weekHalfLife * pushDelta);
            return repo.hotness += weightForWatchers * repo.watchers / createdDelta;
          });
          repos.sort(function(a, b) {
            if (a.hotness < b.hotness) {
              return 1;
            }
            if (b.hotness < a.hotness) {
              return -1;
            }
            return 0;
          });
          LeoSite.repos = repos;
          return LeoSite.renderRepos();
        });
      });
    },
    renderRepos: function() {
      var repoTemplate, reposContent;
      reposContent = [];
      repoTemplate = '<li class="repo grid-1 {{language_lower}}"><a href="{{html_url}}"><h2>{{name}}</h2><h3>{{language}}</h3><p>{{description}}</p></a></li>';
      $.each(LeoSite.repos, function(i, repo) {
        if (repo.language != null) {
          repo.language_lower = repo.language.toLowerCase();
        }
        return reposContent.push(Mustache.render(repoTemplate, repo));
      });
      return $("#repos").html(reposContent.join(""));
    }
  };

  $(function() {
    if ($("#repos").length) {
      return LeoSite.init();
    }
  });

}).call(this);
